[{"title":"ã€çˆ¬è™« | Pythonã€‘è§£å†³â€˜Requests Max Retries Exceeded With Urlâ€˜æŠ¥é”™çš„é—®é¢˜","path":"/2023/03/12/ã€çˆ¬è™« | Pythonã€‘è§£å†³â€˜Requests Max Retries Exceeded With Urlâ€˜æŠ¥é”™çš„é—®é¢˜/","content":"ä¸€ã€æ™®éæ–¹æ¡ˆ ç»†è‡´æ–¹æ¡ˆ ä¸€ã€é—®é¢˜é‡è¿° 1.é”™è¯¯çš„ URL 2.æœªèƒ½éªŒè¯ SSL è¯ä¹¦ 3.ç½‘ç»œä¸ç¨³å®š 4.å‘é€å¤ªå¤šè¯·æ±‚/æœåŠ¡å™¨è¿‡è½½ äºŒã€åº”å¯¹æ–¹æ¡ˆ 1.æ–¹æ¡ˆä¸€ï¼šä»”ç»†æ£€æŸ¥ URL 2.æ–¹æ¡ˆäºŒï¼šè§£å†³SSLError 3.æ–¹æ¡ˆä¸‰ï¼šè§£å†³ç½‘ç»œä¸ç¨³å®šçš„é—®é¢˜ æ–¹æ¡ˆA æ–¹æ¡ˆB 4.æ–¹æ¡ˆå››ï¼šè¶…æ—¶å¤„ç†æœåŠ¡å™¨è¯·æ±‚ èƒŒæ™¯ æˆ‘ä»¬åœ¨å†™çˆ¬è™«çš„æ—¶å€™ï¼Œç»å¸¸ä¼šé‡åˆ°è¿™æ ·çš„æŠ¥é”™ä¿¡æ¯ï¼š HTTPConnectionPool(host=â€˜xxx.xxx.comâ€™, port=443): Max retries exceeded with url: /api/v2/oauth (Caused by NewConnectionError(â€˜&lt;urllib3.connection.HTTPConnection object at 0x7fac5953ab70&gt;: Failed to establish a new connection: [Errno 110] Connection timed outâ€™)) è¿™é‡Œæœ‰2ä¸ªé‡è¦çš„ä¿¡æ¯ç‚¹ï¼Œåˆ†åˆ«æ˜¯ï¼š 1HTTPConnectionPool(host=&#x27;xxx.xxx.com&#x27;, port=443) 1Max retries exceeded with url:xxx (Caused by NewConnectionError(&#x27;&lt;urllib3.connection.HTTPConnection object at 0xxxxx) è§£å†³æ–¹æ¡ˆ ä¸€ã€æ™®éæ–¹æ¡ˆ é’ˆå¯¹ä¸Šè¿°çš„é—®é¢˜ï¼Œç›®å‰ç½‘ä¸Šç»™å‡º3ç§è§£å†³æ–¹æ¡ˆï¼š 1.åœ¨Headersé‡Œæ·»åŠ Connectionå‚æ•°ï¼Œä½¿å…¶ä¸ºcloseï¼Œå› ä¸ºé»˜è®¤ä¸ºkeep-aliveã€‚ å› ä¸ºrequestsä½¿ç”¨çš„httpè¿æ¥æ± åœ¨å‘å‡ºrequeståä¼šç»§ç»­ä¿æŒconnectionå¤„äºæ´»è·ƒçŠ¶æ€ï¼Œè€Œhttpçº¿ç¨‹æ± é‡Œçš„çš„çº¿ç¨‹æ•°æ˜¯æœ‰é™çš„ã€‚å½“å¤šæ¬¡requeståï¼Œéšæœºä½¿ç”¨å®Œäº†çº¿ç¨‹æ± é‡Œçš„sessionï¼Œå› æ­¤ä¸ºé¿å…æ­¤é—®é¢˜éœ€è¦è®¾ç½®connectionä¸ºcloseæ¥æ–­è¿ã€‚ 123headers = &#123; &#x27;Connection&#x27;: &#x27;close&#x27; # è®¾ç½®ä¸ºå…³é—­é•¿è¿æ¥&#125; 2.ä½¿ç”¨requests.close()æ¥å…³é—­è¿æ¥ã€‚ ä½¿ç”¨self.close()ä¸»åŠ¨æ–­å¼€å®‡æœåŠ¡å™¨çš„è¿æ¥ã€‚ 12req = requests.get(url=&#x27;xxx&#x27;, headers=&#x27;xxx&#x27;, data=&#x27;xxx)req.close() # å…³é—­è¿æ¥ 3.ä½¿ç”¨request.sessionï¼ˆï¼‰çš„è¯·æ±‚æ–¹å¼ã€‚ åˆ›å»ºsessionï¼Œç„¶åä¸»åŠ¨æ–­å¼€ã€‚ 123s = requests.session()s.keep_alive = False # å…³é—­å¤šä½™è¿æ¥s.get(url=&#x27;xxx&#x27;, headers=&#x27;xxx&#x27;, data=&#x27;xxx) ä¸Šé¢çš„3ç§æ–¹æ¡ˆä¹Ÿè®¸èƒ½è§£å†³é—®é¢˜ï¼Œä½†æ˜¯ç»è¿‡å°è¯•ï¼Œå¹¶éæ‰€æœ‰æƒ…å†µéƒ½èƒ½æœ‰æ•ˆè§£å†³é—®é¢˜ã€‚ä¸‹é¢ç»™å‡ºæ›´åŠ å…¨é¢å’Œç»†è‡´çš„è§£å†³æ–¹æ¡ˆã€‚ ç»†è‡´æ–¹æ¡ˆ ä¿—è¯è¯´ï¼Œå…·ä½“é—®é¢˜å…·ä½“åˆ†æã€‚â€œå› åœ°åˆ¶å®œâ€æ‰èƒ½çœŸæ­£è§£å†³æ‰€é‡åˆ°çš„é—®é¢˜ã€‚ å½“è¯·æ±‚åº“æ— æ³•æˆåŠŸå°†è¯·æ±‚å‘é€åˆ°å‘å‡ºçš„ç«™ç‚¹æ—¶ï¼Œå°±ä¼šå‘ç”Ÿé”™è¯¯ã€‚å‘ç”Ÿè¿™ç§æƒ…å†µæ˜¯å› ä¸ºä¸åŒçš„åŸå› ã€‚è¿™æ˜¯å¸¸è§çš„ã€‚å…¶ä¸­å¯èƒ½å­˜åœ¨å¦‚ä¸‹çš„é—®é¢˜æ‰€è‡´ï¼š 1.é”™è¯¯çš„ URL ï¼ˆè§£å†³æ–¹æ¡ˆ 1 ï¼‰ 2.æœªèƒ½éªŒè¯ SSL è¯ä¹¦ï¼ˆè§£å†³æ–¹æ¡ˆ 2ï¼‰ 3.ä½¿ç”¨æ²¡æœ‰æˆ–ä¸ç¨³å®šçš„äº’è”ç½‘è¿æ¥çš„è¯·æ±‚ï¼ˆè§£å†³æ–¹æ¡ˆ 3ï¼‰ 4.å‘é€å¤ªå¤šè¯·æ±‚æˆ–æœåŠ¡å™¨å¤ªå¿™ï¼ˆè§£å†³æ–¹æ¡ˆ 4ï¼‰ ä¸€ã€é—®é¢˜é‡è¿° 1.é”™è¯¯çš„ URL å‘ç”Ÿè¿™ç§é”™è¯¯çš„å…¶ä¸­ä¸€ç§å¯èƒ½çš„åŸå› æ˜¯ä½ è¾“å…¥äº†é”™è¯¯çš„URLï¼Œå¯¼è‡´requestè¯·æ±‚ä¸åˆ°æˆ–è¶…æ—¶ã€‚ä¾‹å¦‚ï¼š 1.ä½ æŠŠcomå†™æˆäº†conï¼Œå› æ­¤éœ€è¦è®¤çœŸæ£€æŸ¥URLæ˜¯å¦æ­£ç¡®ã€‚ 123456import requests # é”™è¯¯çš„URLï¼Œåº”ä¸ºhttps://www.github.comhost = &#x27;https://www.github.con&#x27; res = requests.get(url=host)print(res) # æŠ¥é”™ 2.ä½ æ‰€è°ƒç”¨çš„URLå·²å¤±æ•ˆæˆ–ä¸å­˜åœ¨ï¼Œä¾‹å¦‚æŸä¸ªAPIå·²ç»å¤±æ•ˆæˆ–ä¸å­˜åœ¨ï¼Œå› æ­¤ä¼šå‘ç”Ÿæ­¤é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨æµè§ˆå™¨æ£€éªŒä¸€ä¸‹è¯¥URLçš„æœ‰æ•ˆæ€§ã€‚ 123456import requests # ä¸å­˜åœ¨çš„URLæˆ–å·²å¤±æ•ˆçš„URLhost = &#x27;https://www.github.com/api/baidu&#x27; res = requests.get(url=host)print(res) # æŠ¥é”™ ä¸Šè¿°é—®é¢˜è¾“å‡ºï¼š 1requests.exceptions.ConnectionError: HTTPSConnectionPool(host=&#x27;www.github.coxxx&#x27;, port=443): Max retries exceeded with url: / (Caused by NewConnectionError(&#x27;&lt;urllib3.connection.VerifiedHTTPSConnection object at 0x7fd5b5d33100&gt;: Failed to establish a new connection: [Errno 111] Connection refused&#x27;)) å¯ä»¥è§‚å¯Ÿåˆ°æŠ¥é”™ä¿¡æ¯çš„æœ€åéƒ¨åˆ†æ˜¯Connection refusedã€‚ 2.æœªèƒ½éªŒè¯ SSL è¯ä¹¦ é»˜è®¤æƒ…å†µä¸‹ï¼Œè¯·æ±‚åº“å®æ–½ SSL è¯ä¹¦éªŒè¯ä»¥ç¡®ä¿æ‚¨å»ºç«‹å®‰å…¨è¿æ¥ã€‚å¦‚æœæ— æ³•éªŒè¯è¯ä¹¦ï¼Œæ‚¨æœ€ç»ˆä¼šé‡åˆ°å¦‚ä¸‹é”™è¯¯ï¼š 1requests.exceptions.ConnectionError: HTTPSConnectionPool(host=&#x27;www.github.coxxx&#x27;, port=443): Max retries exceeded with url: / (Caused by NewConnectionError(&#x27;&lt;urllib3.connection.VerifiedHTTPSConnection object at 0x7fd5b5d33100&gt;: requests.exceptions.SSLError: [Errno 1] _ssl.c:503: error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify failed&#x27;)) å¯ä»¥è§‚å¯Ÿåˆ°æŠ¥é”™ä¿¡æ¯çš„æœ€åéƒ¨åˆ†æ˜¯certificate verify failedã€‚ 3.ç½‘ç»œä¸ç¨³å®š ä½ æ‰€å‘é€è¯·æ±‚çš„ä¸»æœºä¸ç›®æ ‡æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡è·¯çº¿ä¸ç¨³å®šï¼ˆå¦‚è·¨å›½ï¼‰æˆ–ä¸¤è€…ä¹‹é—´å…¶ä¸­ä¹‹ä¸€çš„å¸¦å®½å—é™å¯¼è‡´çš„ç½‘ç»œä¸ç¨³å®šç°è±¡æ‰€è‡´ï¼š 1Error: requests.exceptions.ConnectionError: HTTPSConnectionPool(host=â€™www.github.comâ€™, port=443): Max retries exceeded with url: / (Caused by NewConnectionError(â€˜&lt;urllib3.connection.VerifiedHTTPSConnection object at 0x7f7f5fadb100&gt;: Failed to establish a new connection: [Errno -3] Temporary failure in name resolutionâ€™)) å¯ä»¥è§‚å¯Ÿåˆ°æŠ¥é”™ä¿¡æ¯çš„æœ€åéƒ¨åˆ†æ˜¯Temporary failure in name resolutionã€‚ 4.å‘é€å¤ªå¤šè¯·æ±‚/æœåŠ¡å™¨è¿‡è½½ å½“å¦‚æ­¤å¿«åœ°å‘å‡ºå¦‚æ­¤å¤šçš„è¯·æ±‚æ—¶ï¼ŒæŸäº›ç½‘ç«™ä¼šé˜»æ­¢è¿æ¥ã€‚ä¸æ­¤ç›¸å…³çš„å¦ä¸€ä¸ªé—®é¢˜æ˜¯å½“æœåŠ¡å™¨è¿‡è½½æ—¶â€”â€”åŒæ—¶ç®¡ç†å¤§é‡è¿æ¥ã€‚æˆ–è€…ä½ çš„IPå·²ç»è¢«ç›®æ ‡æœåŠ¡å™¨åŠ å…¥äº†é»‘åå•ï¼ˆè¢«å°é”IPï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œrequests.get() ä¼šæŠ›å‡ºå¦‚ä¸‹é”™è¯¯ï¼š 1requests.exceptions.ConnectionError: HTTPConnectionPool(host=&#x27;www.github.com&#x27;, port=80): Max retries exceeded with url: / (Caused by NewConnectionError(&#x27;&lt;urllib3.connection.HTTPConnection object at 0x0000008EC69AAA90&gt;: Failed to establish a new connection: [Errno 11001] getaddrinfo failed&#x27;)) 1HTTPConnectionPool(host=&#x27;www.github.com&#x27;, port=80): Max retries exceeded with url: /api/v2/oauth (Caused by NewConnectionError(&#x27;&lt;urllib3.connection.HTTPConnection object at 0x7fac5953ab70&gt;: Failed to establish a new connection: [Errno 110] Connection timed out&#x27;)) äºŒã€åº”å¯¹æ–¹æ¡ˆ 1.æ–¹æ¡ˆä¸€ï¼šä»”ç»†æ£€æŸ¥ URL ç¡®ä¿æ‚¨æ‹¥æœ‰æ­£ç¡®ä¸”æœ‰æ•ˆçš„ URLã€‚è€ƒè™‘å‰é¢æåˆ°çš„æœ‰æ•ˆ URLï¼šâ€œ https://www.github.com â€ã€‚â€œMax retries exceeded with urlâ€é”™è¯¯ä¸»è¦å‘ç”Ÿåœ¨å¯¹www å’Œé¡¶çº§åŸŸåï¼ˆä¾‹å¦‚ .comï¼‰è¿›è¡Œé”™è¯¯ç¼–è¾‘æ—¶ã€‚ å½“æ–¹æ¡ˆ/åè®® (https) è¢«é”™è¯¯ç¼–è¾‘æ—¶ä¼šå‡ºç°å¦ä¸€ä¸ªé”™è¯¯ï¼šrequests.exceptions.InvalidSchemaã€‚å¦‚æœäºŒçº§åŸŸï¼ˆåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯â€œgithubâ€ï¼‰è¢«é”™è¯¯ç¼–è¾‘ï¼Œæˆ‘ä»¬å°†è¢«å¼•å¯¼åˆ°ä¸€ä¸ªå®Œå…¨ä¸åŒçš„ç½‘ç«™ï¼Œå¦‚æœè¯¥ç½‘ç«™ä¸å­˜åœ¨ï¼Œæˆ‘ä»¬ä¼šæ”¶åˆ° 404 å“åº”ã€‚ å¯¼è‡´â€œè¶…è¿‡ url çš„æœ€å¤§é‡è¯•æ¬¡æ•°â€çš„å…¶ä»–é”™è¯¯ URL æ˜¯â€œwwt.github.comâ€å’Œâ€œhttps://www.github.comâ€ï¼ˆ.com ä¹‹åçš„ç©ºæ ¼ï¼‰ã€‚ 2.æ–¹æ¡ˆäºŒï¼šè§£å†³SSLError å¦‚å‰æ‰€è¿°ï¼Œè¯¥é”™è¯¯æ˜¯ç”±ä¸å—ä¿¡ä»»çš„ SSL è¯ä¹¦å¼•èµ·çš„ã€‚æœ€å¿«çš„è§£å†³æ–¹æ³•æ˜¯åœ¨requests.get()ä¸Šè®¾ç½®å±æ€§ verify=Falseã€‚è¿™å‘Šè¯‰ requests åœ¨ä¸éªŒè¯ SSL è¯ä¹¦çš„æƒ…å†µä¸‹å‘é€è¯·æ±‚ã€‚ 1requests.get(&#x27;https://www.github.com&#x27;, verify=False) è¯·æ³¨æ„ï¼Œè¯ä¹¦ä¸ä¼šè¢«éªŒè¯ï¼›å› æ­¤ï¼Œæ‚¨çš„åº”ç”¨ç¨‹åºå°†é¢ä¸´ä¸­é—´äººæ”»å‡»ç­‰å®‰å…¨å¨èƒã€‚å¯¹äºåœ¨ç”Ÿäº§çº§åˆ«ä½¿ç”¨çš„è„šæœ¬ï¼Œæœ€å¥½é¿å…ä½¿ç”¨æ­¤æ–¹æ³•ã€‚ 3.æ–¹æ¡ˆä¸‰ï¼šè§£å†³ç½‘ç»œä¸ç¨³å®šçš„é—®é¢˜ æ­¤è§£å†³æ–¹æ¡ˆé€‚ç”¨äºé—´æ­‡æ€§è¿æ¥ä¸­æ–­çš„æƒ…å†µã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›è¯·æ±‚èƒ½å¤Ÿåœ¨æŠ›å‡ºé”™è¯¯ä¹‹å‰å¯¹è¯·æ±‚è¿›è¡Œå¤šæ¬¡å°è¯•ã€‚å¯¹äºè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼š åœ¨ requests.get() ä¸­å‘å‡ºè¶…æ—¶å‚æ•°ã€‚ åœ¨å‡ºç°ä¸è¿æ¥ç›¸å…³çš„é”™è¯¯æ—¶é‡è¯•è¿æ¥ã€‚ æ–¹æ¡ˆA åœ¨ requests.get() ä¸­å‘å‡ºè¶…æ—¶å‚æ•°ã€‚ 1.å¦‚æœæœåŠ¡å™¨è¿‡è½½ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¶…æ—¶æ¥ç­‰å¾…æ›´é•¿æ—¶é—´çš„å“åº”ã€‚è¿™å°†å¢åŠ è¯·æ±‚æˆåŠŸå®Œæˆçš„æœºä¼šã€‚ 12345import requests url = &#x27;https://www.github.com&#x27;res = requests.get(url, timeout=7)print(res) ä¸Šé¢çš„ä»£ç å°†ç­‰å¾… 7 ç§’ï¼Œä»¥ä¾¿è¯·æ±‚åŒ…è¿æ¥åˆ°ç«™ç‚¹å¹¶è¯»å–æºä»£ç ã€‚ 2.ä½ å¯ä»¥å°†è¶…æ—¶ä½œä¸ºåŒå…ƒç´ å…ƒç»„ä¼ é€’ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯è¿æ¥è¶…æ—¶ï¼ˆä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥çš„æ—¶é—´ï¼‰ï¼Œç¬¬äºŒä¸ªå€¼æ˜¯è¯»å–è¶…æ—¶ï¼ˆå…è®¸å®¢æˆ·ç«¯ä»æœåŠ¡å™¨è¯»å–æ•°æ®çš„æ—¶é—´ï¼‰ 1requests.get(&#x27;https://api.github.com&#x27;, timeout=(3, 7)) ä½¿ç”¨ä»¥ä¸Šçº¿è·¯æ—¶ï¼Œå¿…é¡»åœ¨3ç§’å†…å»ºç«‹è¿æ¥ï¼Œ7ç§’å†…è¯»å–æ•°æ®ï¼›å¦åˆ™ï¼Œè¯·æ±‚ä¼šå¼•å‘è¶…æ—¶é”™è¯¯ã€‚ æ–¹æ¡ˆB åœ¨å‡ºç°è¿æ¥ç›¸å…³é”™è¯¯æ—¶é‡è¯•è¿æ¥. è¿™äº›è¯·æ±‚ä½¿ç”¨urllib3 ä¸­çš„é‡è¯•å®ç”¨ç¨‹åº ( urllib3.util.Retry ) æ¥é‡è¯•è¿æ¥ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ä»¥ä¸‹ä»£ç å‘é€è¯·æ±‚ï¼š 123456789101112131415import requestsfrom requests.adapters import HTTPAdapter, Retryimport time def send_request(url, n_retries=4, backoff_factor=0.9, status_codes=[504, 503, 502, 500, 429]): sess = requests.Session() retries = Retry(connect=n_retries, backoff_factor=backoff_factor, status_forcelist=status_codes) sess.mount(&quot;https://&quot;, HTTPAdapter(max_retries=retries)) sess.mount(&quot;http://&quot;, HTTPAdapter(max_retries=retries)) res = sess.get(url) return res æˆ‘ä»¬åœ¨urllib3.util.Retryç±»ä¸­ä½¿ç”¨äº†ä»¥ä¸‹å‚æ•°ï¼š connect â€“ ä¸è¿æ¥ç›¸å…³çš„å°è¯•æ¬¡æ•°ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ send_request()å°†è¿›è¡Œ 4 æ¬¡å°è¯•åŠ  1 æ¬¡ï¼ˆç«‹å³å‘ç”Ÿçš„åŸå§‹è¯·æ±‚ï¼‰ã€‚ backoff_factor â€“ ç¡®å®šé‡è¯•ä¹‹é—´çš„å»¶è¿Ÿã€‚ä¼‘çœ æ—¶é—´ä½¿ç”¨å…¬å¼&#123;backoff_factor&#125; * (2 ^ (&#123;retry_number&#125; â€“ 1))è®¡ç®—ã€‚æˆ‘ä»¬å°†åœ¨è°ƒç”¨è¯¥å‡½æ•°æ—¶å¤„ç†æ­¤å‚æ•°çš„ç¤ºä¾‹ã€‚ status_forcelist â€“ ä»…é‡è¯•å¯¼è‡´ 504ã€503ã€502ã€500 å’Œ 429 çŠ¶æ€ä»£ç çš„æ‰€æœ‰è¿æ¥ã€‚ ç°åœ¨è®©æˆ‘ä»¬è°ƒç”¨æˆ‘ä»¬çš„å‡½æ•°å¹¶è®¡æ—¶æ‰§è¡Œã€‚ 123456789101112131415# å¼€å§‹ä¸€ä¸ªè®¡æ—¶å™¨start_time = time.time() # è¯·æ±‚Github APIurl = &quot;https://api.github.com/users&quot;res = send_request(url) # æ‰“å°è¿”å›çŠ¶æ€ç print(res.status_code) # ç»“æŸè®¡æ—¶å™¨end_time = time.time() # è®¡ç®—è¿è¡Œæ—¶é•¿print(&quot;Run time: &quot;, end_time-start_time) è¾“å‡ºï¼š 12200Run time: 0.8597214221954346 è¿æ¥å·²æˆåŠŸå®Œæˆï¼ˆçŠ¶æ€ 200ï¼‰ï¼Œè€—æ—¶ 0.86 ç§’ã€‚è¦æŸ¥çœ‹é€€é¿çš„å®ç°ï¼Œè®©æˆ‘ä»¬å°è¯•å‘ä¸å­˜åœ¨çš„æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œåœ¨å¼‚å¸¸å‘ç”Ÿæ—¶æ•è·å¼‚å¸¸å¹¶è®¡ç®—æ‰§è¡Œæ—¶é—´ã€‚ 12345678910111213141516171819try: # å¯åŠ¨æ‰§è¡Œå®šæ—¶å™¨ start_time = time.time() url = &quot;http://localhost/6000&quot; # è°ƒç”¨send_request()æ–¹æ³•å‘urlå‘é€è¯·æ±‚ # è¿™æ°¸è¿œä¸ä¼šæˆåŠŸï¼Œå› ä¸ºæ²¡æœ‰æœåŠ¡å™¨åœ¨è¿è¡Œ # åœ¨ç«¯å£ 6000 ä¸Šã€‚ response = send_request(url) print(response.status_code)except Exception as e: # æ•è·ä»»ä½•å¼‚å¸¸ - æ‰§è¡Œå°†åœ¨è¿™é‡Œç»“æŸï¼Œå› ä¸º # è¯·æ±‚æ— æ³•è¿æ¥åˆ° http://localhost/6000 print(&quot;Error Name: &quot;, e.__class__.__name__) print(&quot;Error Message: &quot;, e)finally: # é€‰æ‹©ç»“æŸæ—¶é—´ end_time = time.time() # è®¡ç®—æ‰§è¡Œæ‰€èŠ±è´¹çš„æ—¶é—´ print(&quot;Run time: &quot;, end_time-start_time) è¾“å‡ºï¼š 123Error Name: ConnectionErrorError Message: HTTPConnectionPool(host=&#x27;localhost&#x27;, port=80): Max retries exceeded with url: /6000 (Caused by NewConnectionError(&#x27;&lt;urllib3.connection.HTTPConnection object at 0x7f06a5862a00&gt;: Failed to establish a new connection: [Errno 111] Connection refused&#x27;))Run time: 12.61784315109253 åœ¨ backoff_factor=0.9 çš„ 4 æ¬¡é‡è¯•ï¼ˆåŠ ä¸Š 1 ä¸ªåŸå§‹è¯·æ±‚ï¼‰ä¹‹åï¼Œæ‰§è¡Œæ—¶é—´ä¸º 12.6 ç§’ã€‚è®©æˆ‘ä»¬ä½¿ç”¨ä¹‹å‰çœ‹åˆ°çš„å…¬å¼æ¥è®¡ç®—ç¡çœ æ—¶é—´ã€‚ 1sleeping_time = &#123;backoff_factor&#125; * (2 ^ (&#123;retry_number&#125; â€“ 1)) æ€»å…±æœ‰5ä¸ªè¯·æ±‚ ç¬¬ä¸€ä¸ªè¯·æ±‚ï¼ˆç«‹å³å‘å‡ºï¼‰â€”â€”ç¡çœ 0 ç§’ï¼Œ ç¬¬ä¸€æ¬¡é‡è¯•ï¼ˆä¹Ÿæ˜¯åœ¨ç¬¬ä¸€æ¬¡è¯·æ±‚å¤±è´¥åç«‹å³å‘é€ï¼‰â€”â€”0ç§’ä¼‘çœ ï¼Œ ç¬¬äºŒæ¬¡é‡è¯•-&gt; 0.9*(2^(2-1)) = 0.9*2 = 1.8 ç§’ç¡çœ ï¼Œ ç¬¬ä¸‰æ¬¡é‡è¯• -&gt; 0.9*(2^(3-1)) = 0.9*4 = 3.6 ç§’çš„ä¼‘çœ æ—¶é—´ï¼Œä»¥åŠï¼Œ ç¬¬å››æ¬¡é‡è¯• -&gt; 0.9*(2^(4-1)) = 0.9*8 = 7.2ç§’ã€‚ è¿™æ˜¯urllib3.util.Retryå®ç°çš„æ€»å…± 12.6 ç§’çš„ä¼‘çœ æ—¶é—´ã€‚å®é™…æ‰§è¡Œæ—¶é—´ä¸º12.61784315109253ç§’ã€‚æœªè¯´æ˜çš„ 0.01784315109253 å·®å¼‚å½’å› äº DNC å’Œä¸€èˆ¬è®¡ç®—æœºç”µæºå»¶è¿Ÿã€‚ 4.æ–¹æ¡ˆå››ï¼šè¶…æ—¶å¤„ç†æœåŠ¡å™¨è¯·æ±‚ ä¸€äº›ç½‘ç«™ä¼šé˜»æ­¢ç½‘ç»œçˆ¬è™«ã€‚ä»–ä»¬æ³¨æ„åˆ°æœºå™¨äººæ­£åœ¨æ ¹æ®ä¼ é€’çš„æ ‡å¤´å‘é€è¯·æ±‚ã€‚ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬è¿è¡Œæ­¤ä»£ç å¹¶æ‰“å¼€è¯¦ç»†ä¿¡æ¯ä»¥æŸ¥çœ‹å¹•åå‘ç”Ÿçš„æƒ…å†µã€‚ 123456789import http.client # turn verbose onhttp.client.HTTPConnection.debuglevel = 1import requestsurl = &#x27;https://www.github.com&#x27;res = requests.get(url=url)print(res) è¾“å‡º(Curl)ï¼š 12send: b&#x27;GET / HTTP/1.1\\r Host: www.github.com\\r User-Agent: python-requests/2.28.1\\r Accept-Encoding: gzip, deflate\\r Accept: */*\\r Connection: keep-alive\\r \\r &#x27;reply: &#x27;HTTP/1.1 200 OK\\r &#x27; åœ¨è¯¥æ—¥å¿—ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ° User-Agent æ˜¯ python-requests v2.28.1 è€Œä¸æ˜¯çœŸæ­£çš„æµè§ˆå™¨ã€‚ä½¿ç”¨æ­¤ç±»æ ‡è¯†ï¼Œæ‚¨å¯èƒ½ä¼šè¢«é˜»æ­¢å¹¶æ”¶åˆ°â€œè¶…è¿‡ url çš„æœ€å¤§é‡è¯•æ¬¡æ•°â€é”™è¯¯ã€‚ä¸ºé¿å…è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦å°†æˆ‘ä»¬çš„å®é™…æµè§ˆå™¨ä½œä¸ºç”¨æˆ·ä»£ç†ä¼ é€’ã€‚æ‚¨å¯ä»¥è½¬åˆ°ä»¥ä¸‹é“¾æ¥è·å–ä¸€äº›æ ‡å¤´ï¼š http://myhttpheader.com/ã€‚åœ¨è¯¥é“¾æ¥ä¸­ï¼Œæˆ‘çš„ç”¨æˆ·ä»£ç†æ˜¯â€œMozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0â€ã€‚ç°åœ¨è®©æˆ‘ä»¬æ”¹ç”¨è¯¥ç”¨æˆ·ä»£ç†ã€‚ 1234567891011import http.client # æ‰“å¼€è¯¦ç»†ä¿¡æ¯http.client.HTTPConnection.debuglevel = 1 import requests headers = &#123;&#x27;User-Agent&#x27;:&#x27;Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0&#x27;&#125;url = &#x27;https://www.github.com&#x27;res = requests.get(url=url, timeout=5, headers=headers)print(res) è¾“å‡º(Curl)ï¼š 12send: b&#x27;GET / HTTP/1.1\\r Host: www.github.com\\r User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0\\r Accept-Encoding: gzip, deflate\\r Accept: */*\\r Connection: keep-alive\\r \\r &#x27;reply: &#x27;HTTP/1.1 200 OK\\r &#x27; é‡è¦ï¼š é’ˆå¯¹è¢«é«˜çº§åçˆ¬åŠè¢«å°ç¦IPçš„è§£å†³æ–¹æ³•ç­–ç•¥æœ‰æ‰€ä¸åŒã€‚ 1.è¢«é«˜çº§åçˆ¬åçš„å¤„ç†ï¼š ä¾‹å¦‚åƒå›½å†…rsè¿™æ ·çš„ä¸­é«˜çº§åŠ¨æ€åçˆ¬æŠ€æœ¯ï¼Œå…¶åŸç†æ˜¯æ£€æµ‹ç”¨æˆ·æµè§ˆå™¨ç¯å¢ƒæ˜¯å¦ä¸ºçœŸå®çš„ç”¨æˆ·ç¯å¢ƒã€‚ é’ˆå¯¹æ­¤ç±»é—®é¢˜éœ€è¦é‡‡ç”¨æ›´åŠ é«˜çº§çš„æ‰‹æ®µè¿›è¡Œæ²™ç›’å®éªŒåŠè¡¥ç¯å¢ƒã€‚ 2.æ‰€ä½¿ç”¨çš„è®¾å¤‡è¢«ç›®æ ‡ä¸»æœºå°ç¦IPã€‚ é’ˆå¯¹æ­¤ç±»é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨IPä»£ç†æ± ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½éšæœºæ›´æ¢IPæ¥é¿å…è¢«å°ç¦ï¼›å…¶æ¬¡ï¼Œéœ€è¦é™ä½è¯·æ±‚çš„é€Ÿç‡ã€‚ æ³¨æ„ï¼šè¯·éµå®ˆæ‰€åœ¨å›½å®¶æˆ–åœ°åŒºçš„æ³•å¾‹æ³•è§„ã€‚ æœ¬æ–‡å±äºä½œè€…è‡ªä¸»çŸ¥è¯†äº§æƒçš„åŸåˆ›æ–‡ç« ï¼Œå¦‚é¡»å¼•ç”¨ã€è½¬è½½ï¼Œè¯·æ³¨æ˜æ¥æºï¼š ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»ã€ŒColynã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚ åŸæ–‡é“¾æ¥ï¼šhttps://blog.inetgeek.cn/","tags":["Python","Spider"],"categories":["ç¼–ç¨‹","Python"]},{"path":"/index.html","content":"Hi, I'm ColynğŸ‘‹ç®€å¢é™Ÿå”Â·éŸ¦åº”ç‰©å¯æ€œç™½é›ªæ›²ï¼Œæœªé‡çŸ¥éŸ³äººã€‚æ“æƒ¶æˆæ—…ä¸‹ï¼Œè¹‰è·æ·®æµ·æ»¨ã€‚æ¶§æ ‘å«æœé›¨ï¼Œå±±é¸Ÿå“¢é¦€æ˜¥ã€‚æˆ‘æœ‰ä¸€ç“¢é…’ï¼Œå¯ä»¥æ…°é£å°˜ã€‚å”è¯—èŠ‚é€‰å…³äºCDNç•™è¨€ç¢è¯­å‹é“¾æ›´æ–° å…³äºæˆ‘å…³äºæœ¬ç«™About Me ğŸ˜€ä¸ªäººç®€ä»‹ ğŸ«æŸ211æœ¬ç§‘ç”Ÿï¼ŒğŸ”¥è½¯ä»¶å·¥ç¨‹ä¸“ä¸šï¼ˆå“è¶Šå·¥ç¨‹å¸ˆè®¡åˆ’ï¼‰ã€‚ğŸ–¥ï¸å¯¹è®¡ç®—æœºåŠWebå……æ»¡å…´è¶£ï¼Œå¥½æŠ˜è…¾ï¼å¯¹è®¡ç®—æœºæ–¹é¢çš„æ–°é²œäº‹ç‰©å……æ»¡å¥½å¥‡ï¼Œä¸”å¯¹å¼€æºé¡¹ç›®åŠä½œè€…å……æ»¡æ•¬æ„ã€‚ğŸ¥° æ›¾å¤§ä¸€å‚åŠ åä½™é¡¹æ¯”èµ›å¹¶è·å¥–ï¼Œå…¶ä¸­å¥–é¡¹æ¶µç›–é™¢çº§è‡³å›½å®¶çº§ã€‚ ğŸ“–å­¦æœ¯é¢†åŸŸ æ„Ÿå…´è¶£ä¸è®¡ç®—æœºè§†è§‰ä¸æ¨¡å¼è¯†åˆ«(CV&PR)ï¼Œæœ¬ç§‘ç§‘ç ”å¸ˆä»CVç•Œå¤§ç‰›æ•™æˆï¼Œä¸»è¦ç ”ç©¶å°æ ·æœ¬å­¦ä¹ (Few-shot Learning)ï¼Œå­¦ä¹ æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ ã€‚ æ¨èä»¥ä¸‹å‡ æœ¬ä¹¦ç±ï¼š ã€Šæœºå™¨å­¦ä¹ ã€‹ -å‘¨å¿—å ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹ -æèˆª ã€Šæ¨¡å¼è¯†åˆ«ã€‹ -å´å»ºé‘« ã€Šæ·±åº¦å­¦ä¹ ã€‹ -Ian Goodfellow / Yoshua Bengioç­‰ ã€Šç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ ã€‹ -é‚±é”¡é¹ ğŸ’»ç¼–ç¨‹ç®—æ³• æ•°æ®ç»“æ„ ç®—æ³•è®¾è®¡ C++ C Shell Python Java JavaScript Scala TypeScript ğŸ”¥æŠ€æœ¯çˆ±å¥½ Webå¼€å‘ï¼ˆå‰åç«¯ã€æ•°æ®åº“ï¼‰ æ¡Œé¢å¼€å‘ã€ç§»åŠ¨ç«¯å¼€å‘ æœºå™¨å­¦ä¹ åŠæ·±åº¦å­¦ä¹  çˆ¬è™«åŠé€†å‘ äº‘è®¡ç®—åŠå¤§æ•°æ® Webå®‰å…¨ã€æ— çº¿ç”µå®‰å…¨ ğŸ“šéƒ¨åˆ†ä½œå“ ç”¨äºé…ç½®RoboMasteræœºç”²å¤§å¸ˆæœåŠ¡å™¨è¿è¡Œç¯å¢ƒçš„æ™ºèƒ½è½¯ä»¶ã€‚ ä½¿ç”¨SpringBootå¼€å‘çš„æ ¡å›­äºŒæ‰‹äº¤æ˜“å¹³å°åç«¯ï¼ŒRESTfulé£æ ¼ã€‚ ç”¨äºé€†å‘rsç¬¬5ä»£åçˆ¬ç³»ç»Ÿçš„çˆ¬è™«ï¼ŒåŸºäºjså’Œpythonã€‚ About Site ğŸŒæœ¬ç«™ç”±hexoé©±åŠ¨ï¼Œé‡‡ç”¨stellarä½œä¸ºä¸»é¢˜ï¼Œæºç æ‰˜ç®¡è‡³githubã€‚ ğŸ’–æ„Ÿè°¢ä»¥ä¸‹å¹³å°æä¾›çš„å…è´¹æœåŠ¡(æ­¤å¤„ä»…å…¬å¸ƒéƒ¨åˆ†æœåŠ¡å•†)ï¼š https://hexo.io/https://hexo.io/ https://xaoxuu.com/wiki/stellar/https://xaoxuu.com/wiki/stellar/ https://github.com/https://github.com/ https://vercel.com/https://vercel.com/ https://www.aliyun.com/https://www.aliyun.com/ https://www.mongodb.com/https://www.mongodb.com/ https://www.fly.io/https://www.fly.io/"},{"path":"/friends/index.html","content":"Hi, I'm ColynğŸ‘‹å…³äºCDNç•™è¨€ç¢è¯­å‹é“¾æ›´æ–° Colyn's Blog"},{"path":"/talks/index.html","content":"ğŸ‰ğŸ‰ğŸ‰There are 0 says totally !!! var memos = { host: 'https://say.inetgeek.cn/', limit: '10', creatorId: '1', domId: '#memos', username: 'Colyn', name: 'Colyn', } hljs.highlightAll();"},{"path":"/update/index.html","content":"Hi, I'm ColynğŸ‘‹å…³äºCDNç•™è¨€ç¢è¯­å‹é“¾æ›´æ–° ğŸŒæœ¬ç«™ç”±hexoé©±åŠ¨ï¼Œé‡‡ç”¨stellarä½œä¸ºä¸»é¢˜ï¼Œæºç æ‰˜ç®¡è‡³githubã€‚ stellaråšå®¢ä¸»é¢˜hexoåšå®¢é©±åŠ¨ stellarä¸»é¢˜ä»“åº“ stellarä¸»é¢˜æ›´æ–° hexoé©±åŠ¨ä»“åº“ stellarä¸»é¢˜æ›´æ–°"}]